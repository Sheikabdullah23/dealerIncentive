<!-- sldsValidatorIgnore -->
<template>
    <article>
        <div class="slds-grid slds-wrap slds-p-around_xx-small slds-m-bottom_small" style="border: 2px solid #D4D4D4;background-color: #ffffff;width: 100%; top:0px; position:sticky;z-index:1;">
            <div class="slds-col slds-size_12-of-12 slds-text-align_center slds-text-heading_medium">
                Dealer Incentive Calculator
            </div>
            <div
                class="slds-col slds-max-small-size--6-of-12 slds-medium-size--1-of-5 slds-large-size--1-of-5 slds-p-horizontal_medium slds-p-vertical_small">
                <lightning-combobox name="year" label="Year" value={year} placeholder="Select Year" options={yearOptions}
                    onchange={handleChange} required></lightning-combobox>
            </div>
            <div
                class="slds-col slds-max-small-size--6-of-12 slds-medium-size--1-of-5 slds-large-size--1-of-5 slds-p-horizontal_medium slds-p-vertical_small">
                <lightning-combobox name="month" label="Month" value={month} placeholder="Select Month"
                    options={monthOptions} onchange={handleChange} required></lightning-combobox>
            </div>
            <div class="slds-col slds-max-small-size--12-of-12 slds-medium-size--1-of-5 slds-large-size--1-of-5"
                style="padding:37px 15px 15px;">
                <lightning-button variant="brand" label="Check Incentive" onclick={handleCheckIncentive}
                    class="actionBtn slds-hide_small  full-width-button"></lightning-button>
                <lightning-button variant="brand" label="Check Incentive" onclick={handleCheckIncentive}
                    class="actionBtn slds-show_small"></lightning-button>
            </div>
            <div class="slds-col slds-max-small-size--12-of-12 slds-medium-size--1-of-5 slds-large-size--1-of-5">
             <div class="totalPay">
              <div class="slds-m-bottom_x-small slds-text-align_center" >TOTAL PAYOUT</div>
              <div class="slds-text-align_center" style="font-size:larger;">â‚¹ {grandTotalPayout}/-</div>
            </div>
            </div>
            <div class="slds-grid slds-wrap slds-size_1-of-5 slds-p-right_small" if:true={accountDet}>
                <div class="slds-grid slds-size_1-of-1" style="display:flex;justify-content:flex-end;">
                    <div>
                        <lightning-icon icon-name='utility:user' alternative-text='approval' size='x-small' title='Dealer'></lightning-icon>
                    </div>
                    <div class="slds-p-left_xx-small" style="font-size:14px; font-weight:bold;">{accountDet.Name}</div>
                </div> 
                <div class="slds-grid slds-size_1-of-1 slds-p-top_small" style="display:flex;justify-content:flex-end;">
                    <div>
                        <lightning-icon icon-name="utility:date_input" size="x-small" alternative-text="Date" title="Date"></lightning-icon>
                    </div>
                    <div style="font-size:14px; font-weight:bold;" class="slds-p-left_xx-small">{currentDate}</div>
                </div>
                <div class="slds-size_1-of-1 slds-p-top_small" style="display:flex;justify-content:flex-end;">
                    <div>
                        <svg xmlns="http://www.w3.org/2000/svg" width="1.5em" height="1em" viewBox="0 0 512 512">
                            <path fill="currentColor" d="M93.8 114.6c-4.7 1.1-1.7.9-5.6 1.4c-16.7 3.6-4.3 6.8 5.6-1.4m293.7 6.7c1.2-.8 5.4-4.9-7.7-8.9c.8 4.1-2.7 3.7-2.7 6c9.7 8.8 13.7 24.1 26.1 27.3c2.4-11-11-16.4-15.7-24.4m-302.6-9.9c1.5 8.9 8.2-9.4 8.3-15.9c-2.6 1.5-5.2 3-7.9 4.2c6.3 3.2.8 6.6-6 11.7c-13.8 17.2 12.9-13.4 5.6 0M256 0C114.6 0 0 114.6 0 256c0 141.3 114.6 256 256 256s256-114.7 256-256C512 114.6 397.4 0 256 0m6.8 85.8l1.2.4c-4.8 6.2 25 24.3 3.6 25.8c-20 5.7 8.4-5.2-7.1-3.3c8.2-11.4-6.5-11.6 2.3-22.9m-121.4 16.4c-7.2-6-29.8 8.2-21.9 4.8c19.6-7.7 1.3.8 5.9 10c-4.2 8.7-1.4-8.6-11.8 1.7c-7.5 1.7-25.9 18.7-23.6 13.5c-.6 8.1-21.9 17.7-24.8 31.2c-7 18.7-1.7-.7-3-8c-10-12.7-28.2 21.5-22.8 35c9.1-16 8.4-1.7 1.8 5.4c6.7 12.3-6.1 28.3 6.6 37.4c5.6 1.3 16.8-18.8 11.9 2.1c3.4-18.1 9.4 4.3 19.1-.7c.6 9.5 6.5 5.1 7.8 16.6c16.2-1.2 31 26.2 11.7 31.4c2.9-.8 8.6 4.3 15.2.4c11.2 8.9 40.7 10 41.5 32c-20.3 9.7-5 36.3-22.6 45.8c-20.2-3-6.9 24.9-15.4 21.7c3.4 20.1-20.4-2.6-11.2 8.5c16.9 10.4-7.4 8.3.2 15.9c-8.5-1.8 5.3 15.8 7.6 22.3c12.2 19.8-10.5-4.4-17.2-11c-6.4-12.8-21.5-37.3-25.7-57.4c-2.4-29.2-25-48.8-30.2-77.3c-5.2-15.9 14.3-41.4 3.8-50.3c-9.1-7.1-5.4-31.4-10.8-44.2C47 130.5 89.9 81.2 141.4 52c-5.3 3.9 30.3-10.1 26.2-6.7c-1.1 2.5 20.8-9.5 34-11.3c-1.4.2-34.3 12-25.2 10.4c-14.1 6.9-1.4 3 5.6-.5c-14 10.3-24.8 7.4-40.7 16.5c-16 4.2-12.7 20.8-24.1 29.1c6.7 1.2 23.5-17.3 33.3-23.8c22.5-10.9-11.4 19.8 10 6.6c-7.2 6.7-5.7 17.4-10.1 20.4c-2.2-.6 8.7 5.2-9 9.5m35-46c-2.3 3.1-5.5 9.8-7.4 5.7c-2.6 1.3-3.6 6.9-8.5 2.4c2.9-2.1 5.9-7.1.2-4c2.6-2.8 25.8-10.7 24.5-13.7c4.1-2.6 3.7-3.9-1-2.3c-2.4-.8 5.7-7.6 16.5-8.5c1.5 0 2.1 1-.6.7c-16.3 5-9.3 3.6 1.7 0c-4.2 2.4-7.1 3.1-7.8 4.2c11-4-.6 2.9 1.9 2.4c-3.1 1.6.5 2.1-5.5 4.4c1.1-.9-9.8 6.5-3.3 4.3c-6.3 6-9.1 6.1-10.7 4.4m9.6 14.3c.2-9.6 14-15.7 12.3-16.2c17-8-5.9.3 7.5-6.9c5-.5 15.6-16.5 30.3-17.5c16.2-4.9 8.7.3 20.7-4.3l-2.4 2c-2.1.3.5 4-7.1 9.6c-.8 8.7-14.5 4.7-7.7 14c-4.4-6.3-11-.2-2.7.4c-8.9 6.8-29.6 8-39.5 19.3c-6.4 9.2-12.3 6.3-11.4-.4m71.1 32c-6.8 16.4-13.4-2.4-1.4-5.4c3 1.6 4.2 2.1 1.4 5.4m-25.6-32.8c-2-7.4-.4-3.5 11.5-7c8.2 5.9-7.3 9.8-11.5 7m186.2 293.5c-9.4-16.2 11.4-31.2 18.4-44.8c-.9 15.9-2.9 31.6-18.4 44.8m35.4-185.1c-10.2.8-19.4 3.2-28.6-2.6c-21.2-23.2 3.9 26.2 10.9 6c25.2 9.6-.4 51-16.3 46.7c-8.9-19.2-19.9-40.3-39.3-49.7c14.9 16.5 22.3 36.8 38.3 51.7c1.1 20.8 22.2-7.6 20.9 8.5c2 27.7-31.3 44.3-25.5 72.1c12.4 25.3-23.9 29.9-19.8 52.6c-14.6 16.3-30.2 38.3-56.4 34.8c0-13.8-7-25.5-8.6-39.7c-14.2-18 15-37.3-3.1-56.1c-20.9-4.7 4.3-33.5-17.2-30.8c-12.9-12.9-31.8-.4-50.3-.3c-23.2 2.2-47.1-28.5-36.8-50.2c-8.2-22.6 26-29.2 26.9-49.1c16.4-13.7 39.7-12 61.9-15.2c-1.6 15.9 15.2 16 27.9 21.3c7.1-17.2 29.2 2.8 44.3-8.1c5.2-25.4-14.7-10.1-26.1-18.2c-13.8-20.2 29.5-10.4 25-21c-16.8-.1-7.3-20.7-19.2-9.2c10.7 1.9-1.9 10.3-1.6.7c-16.2-4.7-.6 18.4-8.8 20.6c-12.5-5.2-6.6 5.9-5.3 7.6c-5.4 11.7-12-17.2-27.3-16.4c-15.2-13.9-6 6.3 7.2 9.6c-2.8.8 1.6 12.3-1.9 7.4c-10.9-15-31.6-25-43.9-6.6c-1.3 17.2-36.3 22.1-30.7 2c-8.2-20.8 25.4-.6 22.3-17.2c-21.6-14.3 5.9-9.7 13.2-23.1c16.6.5.7-13.6 8.5-17.7c-.8 15.3 12.7 12.4 23.4 9.5c-2.6-8.8 6.4-8.5.9-15.8c24.8-9.9-18.9 4.6-10.1-17.1c-10.7-7.4-4.5 16.3 0 18.8c.3 7.3-5.9 16.3-14.4 1c-12.4 8.1-11.1-8.2-11.9-6.5c-1.4-6.3 9.4-6.6 9.5-17.6c-.9-7-.7-10.7 4.3-11.1c.4 1 20.5 1.3 27.6 9.6c-19.4-3.9-2.9 3.2 5.8 7.2c-9.3-7.3 3.7 0-3.9-8.3c3 .6-8.3-11.4 3.3-.9c-6.3-7.5 12.3-5.3 1.3-10.9c16.1 4.5 6.6.4-2.9-3.7c-26.2-15.6 46.3 21.1 16.7 4.8c18.9 4.1-40.4-14.6-13.4-6.4c-10.3-4.5-.3-2 9 .9c-16.7-5.2-41.7-14.9-40.7-15.3c5.8.4 11.5 1.7 17 3.3c17.1 5.1-4.9-1.2-.2-1.1c58.8 15.1 110.3 54.5 141.6 106c7.3 7.7 27.2 58.6 16.8 36c4.7 18 5.4 37.4 7.9 55.8c-5.2-5.8-11-27.2-16-39.1c-2.1 4.6-4.5-6.5-12.2-9.5"/>
                        </svg>
                    </div>
                    <div style="font-size:14px; font-weight:bold;">{dealerRegion}</div>
                </div>
            </div>
        </div>
        <div class="slds-card subCard" if:true={enableCalculator}>
            <!-- <lightning-spinner if:true={isLoading} variant="brand" size="medium" style="background: white;z-index: 11111;top: 10vh">
            </lightning-spinner> -->
            <lightning-spinner if:true={isLoading} alternative-text="Loading....." variant="brand" size="medium" class="slds-align_absolute-center slds-m-bottom_none slds-m-top_none"></lightning-spinner>
            <!-- style="overflow-y: auto;height: 58vh;" -->
            <div class="slds-grid slds-wrap " style="overflow-y: hidden;height: auto;">
                <div class={nav}>
                    <div class="slds-grid" style="cursor: pointer;">
                        <div if:false={isExpand} class="expand_transition slds-p-top_small">
                            <span class="slds-p-left_large" style="font-weight: 600;">{calculatedCount}/{calculatedProducts.length}</span>
                        </div>
                        <div if:true={isExpand} class="expand_transition slds-p-top_small">
                            <span class="slds-p-left_xx-small">Calculated Products: <span style="font-weight: 600;">{calculatedCount}/{calculatedProducts.length}</span></span>
                        </div>
                        <!-- <div if:true={isExpand} class="slds-size_3-of-4 slds-form-element__control">
                                <lightning-input class="slds-p-left_small" placeholder="Search Product" name="productSearch" type="search" onchange={handleSearchChange}></lightning-input>
                            </div> -->
                        <div onclick={handleExpandCollapse} data-name="Click" class={rowIcon}>
                            <lightning-icon icon-name="utility:rows" size="small" alternative-text="Menu!"
                                title="Menu"></lightning-icon>
                        </div>
                    </div>

                    <div style="padding:15px 0px 10px 0px;">
                        <table class="slds-table slds-table_cell-buffer slds-table_header-hidden slds-table_bordered"
                            style="cursor: pointer;">
                            <tbody>
                                <template for:each={calculatedProducts} for:item="product">
                                    <tr key={product} data-name={product.productName} onclick={handleMenuSelection}
                                        class="slds-hint-parent">
                                        <td data-prodname={product.productName} data-name={product.productName} data-label="Product Name" style="font-weight: 500;">
                                            <div class="slds-grid slds-wrap" title={product.productName} data-name={product.productName}>
                                                <div data-name={product.productName}
                                                    class="slds-truncate slds-col slds-size_8-of-12" style="font-weight:600;">
                                                    {product.productName}</div>
                                                <!-- <template if:true={product.value}> -->
                                                    <div if:true={isExpand} data-name={product.productName} data-label="Product Value"
                                                        style="margin-left:auto;">{product.totalPayout}
                                                        <!-- <div data-name={product.productName}
                                                            class="slds-truncate slds-col slds-size_4-of-12" title="value">
                                                            {product.totalPayout}</div> -->
                                                    </div>
                                                <!-- </template> -->
                                            </div>
                                        </td>
                                    </tr>
                                </template>
                                <tr onclick={handleAddSelection}>
                                    <td data-label="Product Name" style="font-weight: 500;">
                                            <div class="slds-grid slds-wrap" title="Additional Incentive">
                                                <div
                                                    class="slds-truncate slds-col slds-size_8-of-12" style="font-weight:600;">
                                                    Additional Incentive</div>
                                                <!-- <template if:true={product.value}> -->
                                                    <div if:true={isExpand} data-label="Product Value"
                                                        style="margin-left:auto;">{addGrandTotalPayout}
                                                        <!-- <div data-name={product.productName}
                                                            class="slds-truncate slds-col slds-size_4-of-12" title="value">
                                                            {product.totalPayout}</div> -->
                                                    </div>
                                                <!-- </template> -->
                                            </div>
                                        </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <div class="slds-col slds-max-small-size--12-of-12 slds-medium-size--12-of-12  slds-hide_large slds-clearfix"
                    style="border:1px solid #D4D4D4">
                    <div class="slds-float_left slds-p-top_small slds-p-left_large slds-p-bottom_small" if:true={hasProduct}
                        style="display:inline;"><b>{selectedProduct.productName}</b>: {selectedProduct.totalPayout}</div>
                    <div data-name="Click"
                        class="slds-float_right slds-size_1-of-4 slds-p-top_small slds-p-left_large slds-p-bottom_small"
                        style="display: inline;">
                        <lightning-icon icon-name="utility:rows" size="small" alternative-text="Menu!" title="Menu"
                            onclick={toggleNav}></lightning-icon>
                    </div>
                    <div class="container">
                        <div class={navClass}>
                            <div
                                class="nav-expanded-small-screen slds-max-small-size--3-of-12 slds-medium-size--2-of-12 slds-large-size--1-of-12 expand_transition">
                                <div class="expand_transition slds-clearfix">
                                    <div class="slds-p-left_xx-small slds-float_left">Calculated Products: <span style="font-weight: 600;">{calculatedCount}/{calculatedProducts.length}</span></div>
                                    <div class="slds-float_right ">
                                        <lightning-icon icon-name="utility:close" size="x-small"
                                            onclick={toggleNavClose} alternative-text="Indicates close"
                                            class="slds-p-right_medium">
                                        </lightning-icon>
                                    </div>
                                </div>

                                <div style="padding:10px 0px 10px 0px;">
                                    <table
                                        class="slds-table slds-table_cell-buffer slds-table_header-hidden slds-table_bordered"
                                        style="cursor: pointer;">
                                        <tbody>
                                            <template for:each={calculatedProducts} for:item="product">
                                                <tr key={product} data-name={product.productName} onclick={handleMenuSelection}
                                                    class="slds-hint-parent">
                                                    <td data-name={product.productName} data-label="Product Name" style="font-weight: 500;">
                                                        <div class="slds-grid slds-wrap" title={product.productName}>
                                                            <div data-name={product.productName}
                                                                class="slds-truncate slds-col slds-size_8-of-12">
                                                                {product.productName}</div>
                                                            <template if:true={product.value}>
                                                                <div data-name={product} data-label="Product Value"
                                                                    style="margin-left:auto;">{product.totalPayout}
                                                                    <!-- <div data-name={product.productName}
                                                                        class="slds-truncate slds-col slds-size_4-of-12"
                                                                        title="value">
                                                                        {product.totalPayout}</div> -->
                                                                </div>
                                                            </template>
                                                        </div>
                                                    </td>
                                                </tr>
                                            </template>
                                            <tr onclick={handleAddSelection}>
                                                 <td data-label="Product Name" style="font-weight: 500;">
                                                        <div class="slds-grid slds-wrap" title="Additional Incentive">
                                                            <div
                                                                class="slds-truncate slds-col slds-size_8-of-12">
                                                                Additional Incentive</div>
                                                         
                                                                <div data-label="Product Value"
                                                                    style="margin-left:auto;">{addGrandTotalPayout}
                                                                    <!-- <div data-name={product.productName}
                                                                        class="slds-truncate slds-col slds-size_4-of-12"
                                                                        title="value">
                                                                        {product.totalPayout}</div> -->
                                                                </div>
                                                        </div>
                                                    </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class={changeGridSize} if:true={hasProduct}>
                    <template if:false={isAddIncentive}>
                        <div class={subcategorySize}>
                            <div class="facet_sidebar">
                                <div class="slds-grid" style="border-bottom:1px solid#C3C5C8; background: #F6F6F6;">
                                    <div class="slds-size_1-of-2 slds-p-left_small" style="padding-top: 30px;">
                                        <span style="font-size: 16px;font-weight: 700;">Sub Category Products</span>
                                    </div>
                                    <div class="slds-size_1-of-2 slds-p-left_small">
                                        <div class="slds-m-around_medium">Total {selectedProduct.productName} Retail Volume : {selectedProduct.totalRetail}</div>
                                        <div class="slds-m-around_medium">Total {selectedProduct.productName} Retail Volume %: {selectedProduct.totalRetailPercentage}</div>
                                    </div>
                                    <!-- <div class="slds-size_1-of-2 slds-p-left_small"
                                        style="display: flex;justify-content: flex-end;">
                                        <lightning-button class="slds-p-right_small clsBtn" variant="brand-outline" label="Clear"
                                            title="" onclick={clearValues}></lightning-button>
                                        <lightning-button class="slds-p-right_small actionBtn" variant="brand" label="Add" title=""
                                            onclick={handleClick}></lightning-button>
                                    </div> -->
                                </div>
                                <div class="slds-grid slds-wrap slds-p-top_small slds-p-bottom_large">
                                    <template for:each={selectedProduct.subProducts} for:item="subProd">
                                        <div key={subProd.name}
                                            class="slds-col slds-max-small-size--1-of-1 slds-medium-size--1-of-1 slds-large-size--1-of-2">
                                            <lightning-input class="slds-p-left_small slds-p-right_small" label={subProd.name}
                                                placeholder="" name={subProd.name} data-subid={subProd.subCategoryId}
                                                value={subProd.volume} type="number"
                                                onchange={handleSubProdInupt}></lightning-input>
                                        </div>
                                    </template>
            
                                </div>
                            </div>
                        </div>
                        <div class={kpiSize}>
                            <!-- <div class="slds-grid slds-wrap slds-p-top_x-large slds-p-left_small"> -->
                                <div class="slds-grid slds-wrap slds-size_1-of-1 slds-medium-size_4-of-5 slds-large-size_5-of-5 slds-p-around_x-small">
                                    <template for:each={selectedProduct.kpiAchivement} for:item="kpiAch">
                                        <div key={kpiAch.Label} class="slds-size_1-of-1">
                                            <template if:false={kpiAch.isCalculated}>
                                                <h6>{kpiAch.Label}</h6>
                                                <div class="slds-form-element">
                                                    <template if:true={kpiAch.isPercentage}>
                                                        <div class="slds-form-element__control">
                                                            <div class="slds-slider tick-icon"
                                                                style="margin-top:-20px;">
                                                                <input type="range"
                                                                    style="width: -webkit-fill-available;height:2px;margin-top:38px;"
                                                                    value={kpiAch.achievedPercentage} data-kpid={kpiAch.kpiId}
                                                                    name={kpiAch.Label} max={maxPercent} min=0
                                                                    oninput={handleKpiAchiveMentInput} />
                                                                <lightning-input class="slds-p-left_large slds-p-bottom_large"
                                                                    data-kpid={kpiAch.kpiId} style="display:block;width: 120px;"
                                                                    value={kpiAch.achievedPercentage}
                                                                    name="marketingPenetration"
                                                                    onchange={handleKpiAchiveMentInput}></lightning-input>
                                                                <div class="slds-p-around_small" style="display:flex; align-items:center;width:100px;">
                                                                    <!-- <lightning-icon icon-name="utility:check" size="small" alternative-text="Achieved" title="Menu"></lightning-icon> -->
                                                                    <!-- <svg xmlns="http://www.w3.org/2000/svg" width="1.5em" height="1.5em" viewBox="0 0 24 24">
                                                                        <path fill="#049a15" stroke="#049a15" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.4" d="M21.86 5.392c.428 1.104-.171 1.86-1.33 2.606c-.935.6-2.126 1.252-3.388 2.365c-1.238 1.091-2.445 2.406-3.518 3.7a55 55 0 0 0-2.62 3.437c-.414.591-.993 1.473-.993 1.473A2.25 2.25 0 0 1 8.082 20a2.24 2.24 0 0 1-1.9-1.075c-.999-1.677-1.769-2.34-2.123-2.577C3.112 15.71 2 15.618 2 14.134C2 12.955 2.995 12 4.222 12c.867.032 1.672.373 2.386.853c.456.306.939.712 1.441 1.245a58 58 0 0 1 2.098-2.693c1.157-1.395 2.523-2.892 3.988-4.184c1.44-1.27 3.105-2.459 4.87-3.087c1.15-.41 2.429.153 2.856 1.258" color="#049a15"/>
                                                                    </svg> -->
                                                                    <template if:true={kpiAch.isAchieved}>
                                                                        <lightning-icon icon-name='action:approval' alternative-text='approval' size='xx-small' title='approval'></lightning-icon>
                                                                    </template>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </template>
                                                    <template if:false={kpiAch.isPercentage}>
                                                        <div class="slds-grid slds-wrap">
                                                            <div
                                                                class="slds-col slds-size_1-of-3 slds-medium-size_4-of-12 slds-large-size_4-of-12">
                                                                <lightning-input name={kpiAch.Label}
                                                                    value={kpiAch.achievedPercentage} data-kpid={kpiAch.kpiId}
                                                                    onchange={handleKpiAchiveMentInput}
                                                                    style="display:block;width: 120px;"></lightning-input>
                                                            </div>
                                                            <div class="slds-size_1-of-3 slds-p-around_small" style="display:flex; align-items:center;width:100px;">
                                                                <!-- <lightning-icon icon-name="utility:check" size="small" alternative-text="Achieved" title="Menu"></lightning-icon> -->
                                                                <!-- <svg xmlns="http://www.w3.org/2000/svg" width="1.5em" height="1.5em" viewBox="0 0 24 24">
                                                                    <path fill="#049a15" stroke="#049a15" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.4" d="M21.86 5.392c.428 1.104-.171 1.86-1.33 2.606c-.935.6-2.126 1.252-3.388 2.365c-1.238 1.091-2.445 2.406-3.518 3.7a55 55 0 0 0-2.62 3.437c-.414.591-.993 1.473-.993 1.473A2.25 2.25 0 0 1 8.082 20a2.24 2.24 0 0 1-1.9-1.075c-.999-1.677-1.769-2.34-2.123-2.577C3.112 15.71 2 15.618 2 14.134C2 12.955 2.995 12 4.222 12c.867.032 1.672.373 2.386.853c.456.306.939.712 1.441 1.245a58 58 0 0 1 2.098-2.693c1.157-1.395 2.523-2.892 3.988-4.184c1.44-1.27 3.105-2.459 4.87-3.087c1.15-.41 2.429.153 2.856 1.258" color="#049a15"/>
                                                                </svg> -->
                                                                <template if:true={kpiAch.isAchieved}>
                                                                    <lightning-icon icon-name='action:approval' alternative-text='approval' size='xx-small' title='approval'></lightning-icon>
                                                                </template>
                                                            </div>
                                                        </div>
                                                    </template>
                                                </div>
                                            </template>
                                        </div>
                                    </template>
        
                                </div>
                                <div class="slds-grid slds-wrap slds-size_1-of-1 slds-medium-size_4-of-5 slds-large-size_5-of-5 slds-p-around_x-small">
                                    <div class="container slds-size_1-of-1">
                                        <h6 class="slds-p-left_small slds-p-top_small" style="font-weight: bold;">Calculation
                                            Summary</h6>
                                        <template for:each={selectedProduct.kpiPayouts} for:item="payout">
                                            <div class="slds-grid slds-p-left_small slds-p-top_large"
                                                key={payout.kpIPayoutName}>
                                                <div class="slds-size_1-of-2">
                                                    <h4>{payout.kpIPayoutName}</h4>
                                                </div>
                                                <div class="slds-size_1-of-2" style="display: flex;justify-content: flex-end; font-weight:600;">
                                                    <span class="slds-p-right_small">{payout.payoutAmount}</span>
                                                </div>
                                            </div>
                                        </template>
        
                                        <div class="slds-border_bottom slds-p-top_small" style="width: 95%;margin-left: 12px;">
                                        </div>
                                        <div class="slds-grid slds-p-left_small  slds-p-bottom_small slds-p-top_small">
                                            <div class="slds-size_1-of-2">
                                                <h5 style="font-weight: 600;font-size: 16px;">Total {selectedProduct.productName} Incentive</h5>
                                            </div>
                                            <div class="slds-size_1-of-2" style="display: flex;justify-content: flex-end;">
                                                <span class="slds-p-right_small"
                                                    style="font-weight: 600; font-size: 16px;">{selectedProduct.totalPayout}</span>
                                            </div>
                                        </div>
                                        <!-- <div class="slds-p-left_small slds-p-top_x-small slds-p-bottom_x-small"
                                        style="display: flex;justify-content: flex-end;background: #FBE3A8;border-bottom-left-radius: 13px;border-bottom-right-radius: 13px;">
                                            <lightning-button class="slds-p-right_small clsBtn" variant="brand-outline" label="Clear"
                                                title="" onclick={clearValues}></lightning-button>
                                            <lightning-button class="slds-p-right_small actionBtn" variant="brand" label="Add" title=""
                                                onclick={handleClick}></lightning-button>
                                        </div> -->
                                    </div>
                                </div>
                            <!-- </div> -->
                        </div>
                    </template>
                    <div class="slds-grid slds-wrap slds-p-around_medium" style="width:100%;" if:true={isAddIncentive}>
                        <template for:each={addKPITargetAndPayout} for:item="addInc">
                            <div if:true={addInc.isVisible} class="slds-size_1-of-3 slds-m-left_small slds-m-top_small" key={add} style="border-radius: 13px; border:1px solid #DDDBDA; height:268px;">
                                <h6 class="slds-p-left_small slds-p-top_small" style="font-weight: bold;">{addInc.productName}</h6>
                                <template for:each={addInc.kpiPayouts} for:item="payout">
                                    <div class="slds-grid slds-p-left_small slds-p-top_large"
                                        key={payout.kpIPayoutName}>
                                        <div class="slds-size_1-of-2">
                                            <h4>{payout.kpIPayoutName}</h4>
                                        </div>
                                        <div class="slds-size_1-of-2" style="display: flex;justify-content: flex-end; font-weight:600;">
                                            <span class="slds-p-right_small">{payout.addPredictedKPIPayout}</span>
                                        </div>
                                    </div>
                                </template>
    
                                <div class="slds-border_bottom slds-p-top_small" style="width: 95%;margin-left: 12px;">
                                </div>
                                <div class="slds-grid slds-p-left_small  slds-p-bottom_small slds-p-top_small">
                                    <div class="slds-size_1-of-2">
                                        <h5 style="font-weight: 600;font-size: 16px;">Total {addInc.productName} Incentive</h5>
                                    </div>
                                    <div class="slds-size_1-of-2" style="display: flex;justify-content: flex-end;">
                                        <span class="slds-p-right_small"
                                            style="font-weight: 600; font-size: 16px;">{addInc.totalAddPredictedPayout}</span>
                                    </div>
                                </div>
                                <!-- <div class="slds-p-left_small slds-p-top_x-small slds-p-bottom_x-small"
                                style="display: flex;justify-content: flex-end;background: #FBE3A8;border-bottom-left-radius: 13px;border-bottom-right-radius: 13px;">
                                    <lightning-button class="slds-p-right_small clsBtn" variant="brand-outline" label="Clear"
                                        title="" onclick={clearValues}></lightning-button>
                                    <lightning-button class="slds-p-right_small actionBtn" variant="brand" label="Add" title=""
                                        onclick={handleClick}></lightning-button>
                                </div> -->
                            </div>
                        </template>
                    </div>
                    <a style="position:relative;left:79%;" onclick={handleNavigateHelpPage}> Click here for more information  </a>  
                </div>
                <div class={changeGridSize} if:false={hasProduct} style="height: 36rem; display:flex; justify-content:center; align-items:center; font-size:16px; font-weight:600;">
                    <span>Targets not configured for this product.</span>
                </div>
            </div>
            <div class="slds-modal__footer slds-clearfix" style="position: sticky; bottom:0;">
                <div class="slds-float_left slds-p-around_small" style="border-right: 2px #C3C5C8 solid;">
                    <span style="font-weight: 500;">Total Retail Volume: <b>{grandTotalVolume}</b></span>
                </div>
                <!-- <div class="slds-float_left" style="border: 1px #C3C5C8 solid;width: 24px;height: 0px;gap: 0px;border: 1px 0px 0px 0px;opacity: 0px;angle: -90 deg;"></div> -->
                <div class="slds-float_left slds-p-around_small">   
                    <span style="font-weight: 500;">Grand Total: <b>{grandTotalPayout}</b></span>
                </div>
                <div class="slds-float_right">
                    <lightning-button class="slds-p-right_medium actionBtn" variant="brand" label="Save" icon-name="utility:save" onclick={handleSave}></lightning-button>
                    <lightning-button class="clsBtn" variant="brand-outline" label="Download"  title="Save & Download" disabled={isDownloadButtonEnabled}
                        icon-name="utility:download" onclick={downloadReport}></lightning-button>
                </div>
            </div>
        </div>
    </article>
</template>